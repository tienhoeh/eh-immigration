<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Applicant Questionnaire - E&H Portal (Simplified Test)</title>
    <link rel="stylesheet" href="/css/style.css">
    <style>
        /* Styles for loading/visibility */
        #auth-loading { display: block; text-align: center; padding: 50px; font-size: 1.2em; color: #555; }
        .container.is-loading { visibility: hidden; opacity: 0; }
        .container.is-visible { visibility: visible; opacity: 1; transition: opacity 0.3s ease-in;}

        /* Ensure container takes height even without iframe */
        .container { min-height: calc(100vh - 160px); /* Adjust based on header/footer */ }
        /* Adjust form container padding since there's no iframe */
        main.form-container {
             padding: 30px;
             overflow: auto; /* Allow scroll if needed */
             background-color: #eee; /* Temp background to see the area */
             min-height: 300px; /* Temp min height */
        }
        .hidden { display: none !important; } /* Ensure hidden works */

    </style>
    <!-- Import Map -->
    <script type="importmap">
      {
        "imports": {
          "@auth0/auth0-spa-js": "https://cdn.jsdelivr.net/npm/@auth0/auth0-spa-js@2.1.3/dist/auth0-spa-js.production.esm.js",
          "/js/auth0_config.js": "/js/auth0_config.js",
          "/js/auth_check.js": "/js/auth_check.js"
        }
      }
    </script>
</head>
<body>
    <!-- Auth Status / Loading Indicator -->
    <div id="auth-status">Initializing and checking authentication...</div>

    <!-- This div will be shown by JavaScript after successful authentication -->
    <div id="page-content" class="hidden">
        <header class="header">
            <h1>Applicant's Questionnaire (Simplified Test)</h1>
             <!-- Display user/logout in header -->
             <div id="user-info" style="position: absolute; top: 15px; right: 20px; color: white; font-size: 0.9em;">
                 <span id="user-email"></span>
                 <button id="btn-logout" class="button logout-button" style="margin-left: 10px; padding: 5px 10px; font-size: 0.8em;">Log Out</button>
             </div>
            <p>This page should load if authentication check succeeds.</p>
        </header>

        <!-- Main container (initially hidden via JS or CSS if preferred) -->
        <div class="container is-loading">
            <nav id="side-nav" class="side-nav">
                <h3>Sections (Navigation Disabled)</h3>
                <!-- Keep the structure but links won't load iframe -->
                <ul>
                    <li><a href="#section-applicant-details">Applicant Details</a></li>
                    <li><a href="#section-parents">Parent's Info</a></li>
                    <li><a href="#section-siblings">Sibling's Info</a></li>
                    <li><a href="#section-education">Education History</a></li>
                    <li><a href="#section-employment">Employment History</a></li>
                    <li><a href="#section-absence">Absence from SG</a></li>
                    <li><a href="#section-passports">Travel Documents</a></li>
                    <li><a href="#section-ns">National Service</a></li>
                    <li><a href="#section-prev-marriage">Previous Marriage</a></li>
                    <li><a href="#section-prev-children">Children (Previous Marriage)</a></li>
                    <li><a href="#section-review">Review & Submit</a></li>
                </ul>
                <!-- Save button (will be disabled as iframe is gone) -->
                <button type="button" id="save-progress" class="button save-button" disabled>Save Draft (Disabled)</button>
                <p id="save-status" class="save-status"></p>
            </nav>

            <main id="form-container" class="form-container">
                <!-- Iframe commented out -->
                <!-- <iframe name="section-iframe" id="section-iframe" src="/sections/section-applicant-details.html" title="Questionnaire Section"></iframe> -->
                <p style="padding: 20px; text-align: center; color: #666;"><i>Questionnaire sections would normally load here in an iframe.</i></p>
                 <p style="padding: 20px; text-align: center;">If you see this page content, the authentication check succeeded without the 403 error.</p>
            </main>
        </div>

        <footer class="footer">
             <p>E&H Consulting Group Pte. Ltd. ...</p>
        </footer>
    </div>

    <!-- Auth Check + Simplified Page Specific Script -->
    <script type="module" src="/js/questionnaire_simple_test.js"></script> <!-- Use a DIFFERENT script file for this test -->
</body>
</html>
